name: üì¶ Publicar no NPM

on:
  push:
    branches:
      - master  # A a√ß√£o ser√° executada apenas para a branch master

jobs:
  publish:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout do reposit√≥rio
        uses: actions/checkout@v3

      - name: Instalar Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18
          registry-url: 'https://registry.npmjs.org'

      - name: Instalar depend√™ncias
        run: npm install

      - name: Build
        run: npm run build

      - name: Garantir um reposit√≥rio limpo
        run: |
          git status
          git add .
          git commit -m "chore: commit antes de vers√£o" || echo "Sem altera√ß√µes para commitar"

      - name: Incrementar a vers√£o
        run: npm version patch -m "Bump version to %s"  # Incrementa a vers√£o patch automaticamente

      - name: Publicar no NPM
        run: npm publish
        env:
          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
